---
title: "airbnb in New York City"
author: "Carole Mattmann und Jonas Zuercher"
date: "13 Februar 2020"
output:
  pdf_document: default
  html_document: default
  word_document: default
---

```{r setup, include=FALSE, echo=TRUE, eval = TRUE}

```

Included packages: 

```{r packages, include=TRUE, echo=TRUE, eval = TRUE, message=FALSE, warning=FALSE}
library(dplyr)
library(tidyverse)
library(geosphere)
library(ggplot2)
```

## Introduction
We are exploring a dataset of airbnb listings in New York City in 2019.

```{r import, eval=, echo=TRUE, include=TRUE}
AB_NYC <- read.csv("../data/AB_NYC_2019.csv", header=TRUE)
str(AB_NYC)
```

## Data cleaning
Following changes have been made to the dataset:

### remove price 0

remove all listings with price 0

```{r price0, include=TRUE, echo=TRUE, eval = TRUE}
AB_NYC <-AB_NYC[AB_NYC$price > 0,]
```

### add log price

add logarithmic price for analysis purposes 
```{r pricelog, include=TRUE, echo=TRUE, eval = TRUE}
AB_NYC <- cbind(AB_NYC,price_log = log(AB_NYC$price))
```

### remove inactive listings

remove inactive listings and make new dataset to compare to full dataset

```{r removeinactive, include=TRUE, echo=TRUE, eval = TRUE}
AB_NYC_available <- AB_NYC %>% 
  filter(availability_365 > 0) 
```

### add distance to Times Square to model

We want to make a statement about how central the place is. Therefore the distance to Times Square is caculated using the latitude and longitude of the listings. The package "geosphere" is used.

Times Square, Manhattan, NY, USA, Latitude and longitude coordinates are: 40.758896, -73.98513

```{r distance_timessquare, include=TRUE, echo=TRUE, eval = TRUE}

coord <- cbind(AB_NYC$longitude,AB_NYC$latitude)
dist.timessquare <- distGeo(p1=coord, p2=c(-73.985130, 40.758896))
AB_NYC <- cbind(AB_NYC,dist.timessquare)
```

### Create subsets for room type

```{r room_subsets, include=TRUE, echo=TRUE, eval = TRUE}

AB_NYC_entirehome <-AB_NYC[AB_NYC$room_type == "Entire home/apt",]

AB_NYC_privateroom <-AB_NYC[AB_NYC$room_type == "Private room",]

AB_NYC_sharedroom <-AB_NYC[AB_NYC$room_type == "Shared room",]
```


## Data visualisation

### Distribution of prices by room types and neighbourhood

```{r plot1, include=TRUE, echo=TRUE, eval = TRUE}

ggplot(data = AB_NYC,
       mapping = aes(y = price_log,
                     x = "",
                     group = neighbourhood_group,
                     colour = neighbourhood_group)) +
  geom_boxplot() +
  facet_wrap(. ~ room_type)+
  xlab("")+
  ylab("log (price in $ per night)")


```

### ?
```{r plots, include=TRUE, echo=TRUE, eval = TRUE}

## price distribution
ggplot(data = AB_NYC,
       mapping = aes(x = price_log,
                     group = room_type,
                     colour = room_type,
                     fill = room_type,
                     alpha = 0.5)) +
  geom_density() +
  xlab("log (price in $ per night)")+
  ylab("density ")

## availability distribution without 0
ggplot(data = AB_NYC_available,
       mapping = aes(x = availability_365)) +
  geom_histogram() +
  xlab("availability")+
  ylab("density ")
```

## Possible models to calculate the price of an airbnb

```{r child = "linear models.rmd""}

```

## Interactive map with the leaflet package







This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.





